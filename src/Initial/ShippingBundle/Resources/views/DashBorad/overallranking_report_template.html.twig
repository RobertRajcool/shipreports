
{% extends 'base.html.twig' %}
{% block body %}
    {% block javascripts %}
        {% javascripts '@InitialShippingBundle/Resources/public/js/aa_jquery-1.8.0.min.js' %}
        <script src="{{ asset_url }}"></script>
        {% endjavascripts %}
        {% javascripts '@InitialShippingBundle/Resources/public/js/highchart/highcharts.js' %}
        <script src="{{ asset_url }}"></script>
        {% endjavascripts %}
        {% javascripts '@InitialShippingBundle/Resources/public/js/highchart/exporting.js' %}
        <script src="{{ asset_url }}"></script>
        {% endjavascripts %}
        {% javascripts '@InitialShippingBundle/Resources/public/js/bootstrap.min.js' %}
        <script src="{{ asset_url }}"></script>
        {% endjavascripts %}
        <script type="text/javascript">
            {{ chart(chart) }}
        </script>
        <script>
            $(document).ready(function()
            {
                {% for kpi in listofkpi %}
                var kpiid={{ kpi.id }};
                var kpiname={{ kpi.kpiName }};
                var temparray={{ kpigraph[kpiid] }};
                alert(temparray);
                kpiname=temparray

                //{{ kpi.kpiName(kpigraph[kpi.id]) }}

                {% endfor %}
                $('#addcommentid').click(function()
                {

                    var kpiid=$('#kpiidforname').val();
                    var comment=$('#usermycommentid').val();

                    var data = {kpiid :kpiid,comment:comment} ;
                    $.ajaxSetup({
                        global: false,
                        type: "post",
                        url: Routing.generate('addcomment_ranking_kpi'),
                        beforeSend: function () {
                            var text='Please Wait';

                            if($('body').find('#resultLoading').attr('id') != 'resultLoading'){
                                $('body').append('<div id="resultLoading" style="display:none"><div><img src="/images/ajax-loader.gif"><div>'+text+'</div></div><div class="bg"></div></div>');
                            }

                            $('#resultLoading').css({
                                'width':'100%',
                                'height':'100%',
                                'position':'fixed',
                                'z-index':'10000000',
                                'top':'0',
                                'left':'0',
                                'right':'0',
                                'bottom':'0',
                                'margin':'auto'
                            });

                            $('#resultLoading .bg').css({
                                'background':'#000000',
                                'opacity':'0.7',
                                'width':'100%',
                                'height':'100%',
                                'position':'absolute',
                                'top':'0'
                            });

                            $('#resultLoading>div:first').css({
                                'width': '250px',
                                'height':'75px',
                                'text-align': 'center',
                                'position': 'fixed',
                                'top':'0',
                                'left':'0',
                                'right':'0',
                                'bottom':'0',
                                'margin':'auto',
                                'font-size':'16px',
                                'z-index':'10',
                                'color':'#ffffff'

                            });

                            $('#resultLoading .bg').height('100%');
                            $('#resultLoading').fadeIn(300);
                            $('body').css('cursor', 'wait');
                        },
                        complete: function () {
                            $('#resultLoading .bg').height('100%');
                            $('#resultLoading').fadeOut(300);
                            $('body').css('cursor', 'default');
                        }
                    });

                    $.ajax({
                        data: data,
                        success: function (data)
                        {

                            $('#usermycommentid').val(' ');
                            $('#commentform').hide();
                            var a=data.lastinsertid;
                            $('#lastid').val(a);
                            $('#viewcommentdiv').text('');
                            if($.isArray(data.resultarray))
                            {
                                // alert('if');
                                $.each(data.resultarray, function(i, listelemnt)
                                {
                                    // alert('eachloop')
                                    $('<span>'+listelemnt.comment+'</span>').appendTo("#viewcommentdiv");


                                });
                            }
                            $('#commentandreportdiv').hide();
                            $('#buttonid').show();
                            alert('Comment Added');
                        }
                        ,
                        error: function()
                        {
                            alert('Error While Generating Image as pdf');

                        }
                    });

                });


            });
        </script>



    {% endblock %}
    <div class="col-md-12 users_advanced_list_views_screen">
        {# <div class="page-header">
             <h2>{{ shipname.shipName }}</h2>
             <a href="{{ path('dashboradhome') }}">Back</a>
         </div>#}
        <div class="table-responsive">
            <table class="table table-striped-4 element_ranking_main_title_row">
                <thead>
                <tr>
                    <th colspan="4">
                        {{ 'kpiranking.header'|trans }}
                        {#<a class="linkclass" href="{{ path('dashboardhome', { 'year':currentyear}) }}" style="float: right"  >{{ 'elementranking.backlink'|trans }}</a>#}

                    </th>

                </tr>
                </thead>
                <tbody>
                <tr>
                    <td><strong>{{ 'kpiranking.veseelname'|trans }}</strong></td>
                    <td>{{ shipname }}</td>
                    <td><strong>{{ 'kpiranking.techmanager'|trans }}</strong></td>
                    <td>V-ships</td>
                </tr>
                <tr>
                    <td><strong>{{ 'kpiranking.year'|trans }}</strong></td>
                    <td>{{ currentyear }}</td>
                    <td><strong>{{ 'kpiranking.ageofvessel'|trans }}</strong></td>
                    <td>{{ ageofvessel }}</td>
                </tr>
                </tbody>
            </table>
            <table class="table table-striped-2 kpi_ranking_row">
                <thead>
                <tr>

                    <th class="kpi_name kpi_name_thtd">{{ 'kpiranking.kpi'|trans }}</th>
                    <th class="weightage">{{ 'kpiranking.weightage'|trans }}</th>
                    {% for monthname in montharray %}
                        <th class="month">{{ monthname }}</th>
                    {% endfor %}

                </tr>
                </thead>
                <tbody>
                {% set countmonth1= countmonth-1 %}
                {% set i=0 %}
                {% for kpi in listofkpi %}
                    <tr>
                        <td class="kpi_name_thtd"><a
                                    href="{{ path('listelementforkpi_ranking', { 'kpiid': kpi.id }) }}"
                                    title="{{ kpi.kpiName }}">
                                {{ kpi.kpiName }}
                            </a></td>
                        <td>{{ kpiweightage[i] }}</td>

                        {% for j in 0..countmonth1 %}
                            {#{% set newcolorarray = newcolorarray|merge({('_'~akj):(kpicolorarray[j][i])}) %}#}
                            <td>
                                {{ kpimonthdata[j][i] }}
                            </td>
                            {# {% set akj=akj+1 %}#}

                        {% endfor %}

                    </tr>
                    {% set i=i+1 %}
                {% endfor %}

                <tr>
                    <td colspan="" class="kpi_name_thtd"><strong>{{ 'kpiranking.avgscore'|trans }}</strong></td>
                    <td>100</td>

                    {% for avg in avgscore %}
                        <td><strong>{{ avg }}</strong></td>
                    {% endfor %}
                </tr>
                </tbody>
                </tbody>
            </table>

            <table class="table table-striped normal_table">
                <thead>
                <tr>
                    <th>{{ shipname }}</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td id="area"></td>
                </tr>
                </tbody>
            </table>
            {% for kpi in listofkpi %}
                <table class="table table-striped normal_table">
                    <thead>
                    <tr>
                        <th>{{ kpi.kpiName }}</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td id="{{ kpi.id }}"></td>
                    </tr>
                    </tbody>
                </table>
            {% endfor %}
        </div>



    </div>
{% endblock %}

